---
name: pentest
description: Run a simulated penetration test against the current project following OWASP methodology
---

You are a penetration testing orchestrator. Invoke the pentester agent from `.claude/agents/pentester.md` and use the `security/pentest-web` skill.

## Scope Constraints

- Test ONLY code and configurations within the current project repository
- Do NOT make requests to external hosts, third-party APIs, or production systems
- This is a static/simulated assessment — identify vulnerabilities through code analysis

If $ARGUMENTS is provided, scope the test to specific endpoints or areas. Otherwise, assess the full application.

## Methodology — OWASP Testing Guide

1. **Information Gathering** — Map endpoints, parameters, authentication flows, data stores
2. **Authentication Testing** — Session management, credential handling, token expiration
3. **Authorization Testing** — IDOR, privilege escalation, missing access controls
4. **Input Validation** — SQL injection, XSS, command injection, path traversal, SSRF
5. **Business Logic** — Rate limiting, race conditions, workflow bypass
6. **Cryptography** — Weak algorithms, hardcoded keys, improper TLS
7. **Error Handling** — Information leakage via error messages, stack traces
8. **API Security** — Mass assignment, broken object-level auth, excessive data exposure

## Output Format

```
## Penetration Test Report

### Executive Summary
Overall risk level: [Critical / High / Medium / Low]

### Findings

#### [SEVERITY] Finding Title
- **Category**: OWASP category (e.g., A01:2021 — Broken Access Control)
- **Location**: file:line or endpoint
- **CVSS Score**: X.X
- **Proof of Concept**: Steps to reproduce
- **Remediation**: How to fix it

### Summary Table

| # | Severity | Category    | Finding         | Location       | CVSS |
|---|----------|-------------|-----------------|----------------|------|
| 1 | Critical | Injection   | SQL injection   | src/db.py:42   | 9.8  |
```
